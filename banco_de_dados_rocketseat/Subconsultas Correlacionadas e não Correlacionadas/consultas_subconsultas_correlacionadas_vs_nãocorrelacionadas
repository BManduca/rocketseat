
select product_id, product_name, price
  from products
where price > (
  select avg(price) from products
);

select round(avg(price),2) from products;


select
  c.customer_id,
  c.first_name || ' ' || c.last_name as nome_completo,
  (
    select count(*)
      from orders o
      where o.customer_id = c.customer_id
  ) as total_pedidos
from customers as c



-- SUBCONSULTA CORRELACIONADA
select 
  c.customer_id,
  c.first_name,
  (select count(*) from orders o where o.customer_id = c.customer_id) as total_pedidos
from customers as c;

-- REESCRITA COM JOIN + GROUP BY
select
  c.customer_id,
  c.first_name,
  count(o.order_id) as total_pedidos
from customers as c
left join orders as o
  on c.customer_id = o.customer_id
group by c.customer_id, c.first_name;


